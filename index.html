<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Den of Shadow - Lord of Light</title>
    <style>
        :root { --p-color: #9932CC; --ui-font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        * { box-sizing: border-box; touch-action: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; background: #050505; color: #eee; font-family: var(--ui-font); overflow: hidden; }
        
        #hud { position: absolute; top: 20px; left: 20px; z-index: 100; pointer-events: none; }
        .bar-container { width: 200px; height: 12px; background: rgba(0,0,0,0.5); border: 1px solid #333; margin-bottom: 10px; border-radius: 6px; overflow: hidden; }
        #hp-bar { width: 100%; height: 100%; background: linear-gradient(90deg, #ff0000, #880000); transition: width 0.3s; }
        
        #weapon-info { font-weight: bold; font-size: 18px; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        #controls-hint { position: absolute; bottom: 20px; left: 20px; font-size: 12px; opacity: 0.6; pointer-events: none; }

        /* Botões Mobile/Console Overlay */
        #mobile-btns { position: absolute; bottom: 30px; right: 30px; display: flex; gap: 15px; z-index: 100; }
        .btn-ui { width: 65px; height: 65px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; cursor: pointer; }
        .btn-ui:active { transform: scale(0.9); background: rgba(255,255,255,0.3); }
        
        canvas { display: block; image-rendering: pixelated; }
    </style>
</head>
<body>

<div id="hud">
    <div class="bar-container"><div id="hp-bar"></div></div>
    <div id="weapon-info">ARMA: <span id="weapon-txt">LUZ</span></div>
</div>

<div id="controls-hint">WASD: MOVER | SETAS: ATACAR | Q: TROCAR ARMA | SUPORTE A CONSOLE ATIVO</div>

<div id="mobile-btns">
    <div class="btn-ui" onclick="swapWeapon()">Q</div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
// --- CONFIGURAÇÃO GLOBAL ---
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const ROOM_W = 3000, ROOM_H = 3000;

const G = {
    play: true,
    curWpn: 0,
    unlockedWeapons: [0, 1, 2], // 0:Luz, 1:Fogo, 2:Espada do Rei
    weapons: [
        { id: 0, name: "Luz", type: 'range', color: "#fff", dmg: 35, rate: 180, spd: 12 },
        { id: 1, name: "Fogo", type: 'range', color: "#ff4500", dmg: 85, rate: 450, spd: 8 },
        { id: 2, name: "Espada do Rei", type: 'melee', color: "#9932CC", dmg: 160, rate: 400, range: 110 }
    ],
    lastShot: 0,
    camera: { x: 0, y: 0, lerp: 0.1 }
};

let player = { x: 1500, y: 1500, r: 28, spd: 7, hp: 100, maxHp: 100, angle: 0 };
let keys = {};
let projectiles = [];
let enemies = [];
let visuals = [];

// Gerador de inimigos simples para teste
for(let i=0; i<20; i++) {
    enemies.push({
        x: Math.random() * ROOM_W,
        y: Math.random() * ROOM_H,
        r: 30, hp: 100, spd: 2 + Math.random() * 2
    });
}

// --- SISTEMA DE ENTRADA (MOBILE/CONSOLE/PC) ---
window.addEventListener('keydown', e => {
    const k = e.key.toLowerCase();
    keys[k] = true;
    if(k === 'q') swapWeapon(); // Troca de arma no Q
});
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

function swapWeapon() {
    let currentIdx = G.unlockedWeapons.indexOf(G.curWpn);
    G.curWpn = G.unlockedWeapons[(currentIdx + 1) % G.unlockedWeapons.length];
    
    const w = G.weapons.find(wp => wp.id === G.curWpn);
    const txt = document.getElementById('weapon-txt');
    txt.innerText = w.name;
    txt.style.color = w.color;
} <!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Den of Shadow - Corrigido</title>
    <style>
        body { margin: 0; background: #050505; overflow: hidden; color: white; font-family: sans-serif; }
        canvas { display: block; width: 100vw; height: 100vh; }
        #hud { position: absolute; top: 20px; left: 20px; z-index: 10; pointer-events: none; }
        .bar { width: 200px; height: 10px; background: #222; border: 1px solid #444; margin-bottom: 5px; }
        #hp-fill { width: 100%; height: 100%; background: red; transition: 0.3s; }
        #wpn-txt { font-weight: bold; font-size: 20px; text-shadow: 0 0 10px currentColor; }
    </style>
</head>
<body>
<div id="hud">
    <div class="bar"><div id="hp-fill"></div></div>
    <div id="wpn-txt">ARMA: LUZ</div>
</div>
<canvas id="gameCanvas"></canvas>
<script>
// Início da Lógica dentro do HTML
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const G = {
    play: true, curWpn: 0, unlockedWeapons: [0, 1, 2],
    weapons: [
        { id: 0, name: "LUZ", type: 'range', color: "#fff", dmg: 30, rate: 200 },
        { id: 1, name: "FOGO", type: 'range', color: "#ff4500", dmg: 70, rate: 400 },
        { id: 2, name: "REI", type: 'melee', color: "#9932CC", dmg: 150, rate: 500 }
    ],
    lastShot: 0, camX: 0, camY: 0
};
let player = { x: 1000, y: 1000, r: 25, spd: 7, angle: 0, hp: 100 };
let enemies = []; // Adicione inimigos aqui
let projectiles = [];
let visuals = [];
let keys = {};
